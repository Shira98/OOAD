Imports MySql.Data.MySqlClient

Public Class HomePage
    Private Connect As New MySqlConnection("server=10.100.1.211;user id=Synche;database=sys; password=Shira_98;integrated security=true;")

    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load

    End Sub

    Private Sub BQuit_Click(sender As Object, e As EventArgs) Handles BQuit.Click
        'Connect.Close()
        Me.Close()
    End Sub

    Private Sub BGo_Click(sender As Object, e As EventArgs) Handles BGo.Click

        'Inserts an entry into the database ids.
        
        Dim insertQ As String = "INSERT INTO ids (ID, NAME, DESIGNATION, BRANCH) VALUES('" & TBID.Text & "','" & TBName.Text & "','" & TBDesig.Text & "','" & TBBranch.Text & "')"

        ExecuteQuery(insertQ)

    End Sub

    Public Sub ExecuteQuery(query As String)
        Dim cmd As New MySqlCommand(query, Connect)
        Connect.Open()
        cmd.ExecuteNonQuery()
        Connect.Close()
    End Sub

    Private Sub BDelete_Click(sender As Object, e As EventArgs) Handles BDelete.Click
        Dim delQ As String = "DELETE FROM ids where (ID = '" & TBID.Text & "')"
        ExecuteQuery(delQ)
    End Sub

    Private Sub BSort_Click(sender As Object, e As EventArgs) Handles BSort.Click

    End Sub
End Class

